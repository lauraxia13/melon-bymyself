name: Check Melon Ticket

on:
  schedule:
    - cron: '*/5 * * * *'   # æ¯5åˆ†é’Ÿè¿è¡Œä¸€æ¬¡
  workflow_dispatch:        # å…è®¸ä½ æ‰‹åŠ¨ç‚¹è¿è¡Œ

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Check Melon Ticket
        uses: mooyoul/melon-ticket-actions@v1.1.0
        with:
          product-id: 212678        # å…ˆéšä¾¿å¡«
          schedule-id: 100003       # å…ˆéšä¾¿å¡«
          seat-id: ST0001              # ç¤ºä¾‹
          message: 'ğŸ« Melon æœ‰ç¥¨äº†ï¼å¿«å»æŠ¢ï¼'

      - name: Create issue when ticket is available
        if: success()
        uses: actions/github-script@v7
        with:
          script: |
            await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: "ğŸ« Melon æœ‰ç¥¨æé†’",
              body: "æ£€æµ‹åˆ° Melon æœ‰ç¥¨äº†ï¼Œå¿«å»å®˜ç½‘æŠ¢ï¼"
            });
